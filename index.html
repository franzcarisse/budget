<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Budget Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <!-- Admin Login Modal -->
    <div id="loginModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
            <div class="p-6">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Administrator Login</h2>
                    <p class="text-gray-600">Please enter your credentials to access the system</p>
                </div>
                
                <form id="loginForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                        <input type="text" id="username" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <input type="password" id="password" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none">
                    </div>
                    <div id="loginError" class="hidden text-red-600 text-sm text-center"></div>
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                        Login
                    </button>
                </form>
                
                <div class="mt-4 text-xs text-gray-500 text-center">
                    Demo credentials: admin / password123
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-6 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="flex justify-between items-center mb-4">
                <div></div>
                <div>
                    <h1 class="text-4xl font-bold text-gray-800 mb-2">Project Budget Tracker</h1>
                    <p class="text-gray-600">Monitor and track budget utilization across all projects</p>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="adminBtn" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
                        Admin Panel
                    </button>
                    <button id="logoutBtn" class="hidden bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
                        Logout
                    </button>
                </div>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="hidden bg-white rounded-xl shadow-lg p-6 mb-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Administrator Panel</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- File Upload Section -->
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors">
                    <div class="mb-4">
                        <svg class="w-12 h-12 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                    </div>
                    <h4 class="text-lg font-medium text-gray-800 mb-2">Upload Project Data</h4>
                    <p class="text-gray-600 mb-4">Upload an Excel file (.xlsx) with project information</p>
                    <input type="file" id="fileInput" accept=".xlsx,.xls" class="hidden">
                    <button onclick="document.getElementById('fileInput').click()" 
                            class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        Choose File
                    </button>
                    <div id="fileName" class="mt-2 text-sm text-gray-600"></div>
                </div>

                <!-- Upload Status -->
                <div class="space-y-4">
                    <div>
                        <h4 class="text-lg font-medium text-gray-800 mb-2">Upload Status</h4>
                        <div id="uploadStatus" class="text-gray-600">No file uploaded</div>
                    </div>
                    
                    <div>
                        <h4 class="text-lg font-medium text-gray-800 mb-2">Expected Format</h4>
                        <div class="text-sm text-gray-600 space-y-1">
                            <p><strong>Columns:</strong> Name, Manager, Status, Total Budget, Used Budget, Category</p>
                            <p><strong>Expenses Sheet:</strong> Project ID, Description, Category, Date, Amount</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Search Bar -->
        <div class="max-w-2xl mx-auto mb-8">
            <div class="relative">
                <input 
                    type="text" 
                    id="searchInput"
                    placeholder="Search projects by name, status, or manager..."
                    class="w-full px-6 py-4 text-lg border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none shadow-lg transition-all duration-300"
                >
                <div class="absolute right-4 top-1/2 transform -translate-y-1/2">
                    <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Projects Grid -->
        <div id="projectsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Projects will be populated here -->
        </div>

        <!-- No Results Message -->
        <div id="noResults" class="hidden text-center py-12">
            <div class="text-gray-400 mb-4">
                <svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.467-.881-6.08-2.33"></path>
                </svg>
            </div>
            <h3 class="text-xl font-semibold text-gray-600 mb-2">No projects found</h3>
            <p class="text-gray-500">Try adjusting your search terms</p>
        </div>

        <!-- Project Detail Modal -->
        <div id="projectModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 overflow-y-auto">
            <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full mx-auto my-8 m-4">
                <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                    <h2 id="modalTitle" class="text-2xl font-bold text-gray-800"></h2>
                    <button id="closeModal" class="text-gray-400 hover:text-gray-600 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="p-6">
                    <!-- Project Overview -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="bg-blue-50 rounded-lg p-4">
                            <h3 class="text-sm font-medium text-blue-600 mb-1">Total Budget</h3>
                            <p id="modalTotalBudget" class="text-2xl font-bold text-blue-800"></p>
                        </div>
                        <div class="bg-green-50 rounded-lg p-4">
                            <h3 class="text-sm font-medium text-green-600 mb-1">Used Budget</h3>
                            <p id="modalUsedBudget" class="text-2xl font-bold text-green-800"></p>
                        </div>
                        <div class="bg-purple-50 rounded-lg p-4">
                            <h3 class="text-sm font-medium text-purple-600 mb-1">Remaining</h3>
                            <p id="modalRemainingBudget" class="text-2xl font-bold text-purple-800"></p>
                        </div>
                    </div>

                    <!-- Budget Utilization Chart -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Budget Utilization</h3>
                        <div class="bg-gray-100 rounded-lg p-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-gray-700">Progress</span>
                                <span id="modalUtilizationPercent" class="text-sm font-bold text-gray-800"></span>
                            </div>
                            <div class="w-full bg-gray-300 rounded-full h-4">
                                <div id="modalProgressBar" class="h-4 rounded-full transition-all duration-500"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Project Details -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-3">Project Information</h3>
                            <div class="space-y-3">
                                <div>
                                    <span class="text-sm text-gray-500">Manager:</span>
                                    <span id="modalManager" class="ml-2 font-medium text-gray-800"></span>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500">Status:</span>
                                    <span id="modalStatus" class="ml-2 px-2 py-1 rounded-full text-xs font-medium"></span>
                                </div>
                                <div>
                                    <span class="text-sm text-gray-500">Category:</span>
                                    <span id="modalCategory" class="ml-2 font-medium text-gray-800"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Expenses List -->
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Expense Breakdown</h3>
                        <div class="bg-gray-50 rounded-lg overflow-hidden">
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                                            <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                            <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody id="expensesList" class="bg-white divide-y divide-gray-200">
                                        <!-- Expenses will be populated here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Authentication state
        let isLoggedIn = false;
        const adminCredentials = { username: 'admin', password: 'password123' };
        
        // Project data - will be populated from Excel file
        let projects = [
            {
                id: 1,
                name: "Website Redesign",
                manager: "Sarah Johnson",
                status: "In Progress",
                totalBudget: 50000,
                usedBudget: 32000,
                category: "Web Development",
                expenses: [
                    { description: "UI/UX Design Services", category: "Design", date: "2024-01-15", amount: 12000 },
                    { description: "Frontend Development", category: "Development", date: "2024-01-20", amount: 15000 },
                    { description: "Content Management System", category: "Software", date: "2024-02-01", amount: 3500 },
                    { description: "Testing & QA", category: "Quality Assurance", date: "2024-02-10", amount: 1500 }
                ]
            },
            {
                id: 2,
                name: "Mobile App Development",
                manager: "Mike Chen",
                status: "Planning",
                totalBudget: 120000,
                usedBudget: 15000,
                category: "Mobile Development",
                expenses: [
                    { description: "Project Planning & Analysis", category: "Planning", date: "2024-01-10", amount: 8000 },
                    { description: "Wireframe & Prototyping", category: "Design", date: "2024-01-25", amount: 7000 }
                ]
            },
            {
                id: 3,
                name: "Marketing Campaign Q4",
                manager: "Emily Rodriguez",
                status: "Active",
                totalBudget: 75000,
                usedBudget: 68000,
                category: "Marketing",
                expenses: [
                    { description: "Social Media Advertising", category: "Advertising", date: "2024-01-05", amount: 25000 },
                    { description: "Content Creation", category: "Creative", date: "2024-01-12", amount: 18000 },
                    { description: "Influencer Partnerships", category: "Partnerships", date: "2024-01-20", amount: 15000 },
                    { description: "Email Marketing Platform", category: "Software", date: "2024-02-01", amount: 5000 },
                    { description: "Analytics & Reporting Tools", category: "Tools", date: "2024-02-05", amount: 5000 }
                ]
            },
            {
                id: 4,
                name: "Data Analytics Platform",
                manager: "David Kim",
                status: "In Progress",
                totalBudget: 200000,
                usedBudget: 95000,
                category: "Analytics",
                expenses: [
                    { description: "Cloud Infrastructure Setup", category: "Infrastructure", date: "2024-01-08", amount: 35000 },
                    { description: "Database Development", category: "Development", date: "2024-01-15", amount: 28000 },
                    { description: "Data Visualization Tools", category: "Software", date: "2024-01-22", amount: 15000 },
                    { description: "Security Implementation", category: "Security", date: "2024-02-01", amount: 12000 },
                    { description: "Performance Optimization", category: "Development", date: "2024-02-08", amount: 5000 }
                ]
            },
            {
                id: 5,
                name: "Office Renovation",
                manager: "Lisa Thompson",
                status: "Completed",
                totalBudget: 80000,
                usedBudget: 78500,
                category: "Infrastructure",
                expenses: [
                    { description: "Construction Materials", category: "Materials", date: "2023-12-01", amount: 35000 },
                    { description: "Labor Costs", category: "Labor", date: "2023-12-15", amount: 25000 },
                    { description: "Furniture & Equipment", category: "Equipment", date: "2024-01-05", amount: 12000 },
                    { description: "Electrical Work", category: "Utilities", date: "2023-12-20", amount: 4500 },
                    { description: "Final Inspections", category: "Compliance", date: "2024-01-10", amount: 2000 }
                ]
            },
            {
                id: 6,
                name: "Customer Portal",
                manager: "James Wilson",
                status: "In Progress",
                totalBudget: 90000,
                usedBudget: 45000,
                category: "Web Development",
                expenses: [
                    { description: "Backend API Development", category: "Development", date: "2024-01-12", amount: 20000 },
                    { description: "User Authentication System", category: "Security", date: "2024-01-18", amount: 12000 },
                    { description: "Database Design", category: "Database", date: "2024-01-25", amount: 8000 },
                    { description: "Frontend Framework Setup", category: "Development", date: "2024-02-02", amount: 5000 }
                ]
            }
        ];

        function getStatusColor(status) {
            const colors = {
                'Planning': 'bg-yellow-100 text-yellow-800',
                'In Progress': 'bg-blue-100 text-blue-800',
                'Active': 'bg-green-100 text-green-800',
                'Completed': 'bg-gray-100 text-gray-800'
            };
            return colors[status] || 'bg-gray-100 text-gray-800';
        }

        function getBudgetColor(percentage) {
            if (percentage >= 90) return 'bg-red-500';
            if (percentage >= 75) return 'bg-yellow-500';
            if (percentage >= 50) return 'bg-blue-500';
            return 'bg-green-500';
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0
            }).format(amount);
        }

        function createProjectCard(project) {
            const utilizationPercentage = Math.round((project.usedBudget / project.totalBudget) * 100);
            const remainingBudget = project.totalBudget - project.usedBudget;
            
            return `
                <div class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-100 cursor-pointer" onclick="openProjectModal(${project.id})">
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-xl font-semibold text-gray-800 leading-tight">${project.name}</h3>
                            <span class="px-3 py-1 rounded-full text-sm font-medium ${getStatusColor(project.status)}">
                                ${project.status}
                            </span>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-gray-600 mb-1">Project Manager</p>
                            <p class="font-medium text-gray-800">${project.manager}</p>
                        </div>

                        <div class="mb-4">
                            <p class="text-sm text-gray-500 mb-1">${project.category}</p>
                        </div>

                        <!-- Budget Progress -->
                        <div class="mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-gray-700">Budget Utilization</span>
                                <span class="text-sm font-bold text-gray-800">${utilizationPercentage}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div class="h-3 rounded-full transition-all duration-500 ${getBudgetColor(utilizationPercentage)}" 
                                     style="width: ${utilizationPercentage}%"></div>
                            </div>
                        </div>

                        <!-- Budget Details -->
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p class="text-gray-500 mb-1">Total Budget</p>
                                <p class="font-semibold text-gray-800">${formatCurrency(project.totalBudget)}</p>
                            </div>
                            <div>
                                <p class="text-gray-500 mb-1">Used</p>
                                <p class="font-semibold text-gray-800">${formatCurrency(project.usedBudget)}</p>
                            </div>
                            <div class="col-span-2">
                                <p class="text-gray-500 mb-1">Remaining</p>
                                <p class="font-semibold ${remainingBudget < project.totalBudget * 0.1 ? 'text-red-600' : 'text-green-600'}">
                                    ${formatCurrency(remainingBudget)}
                                </p>
                            </div>
                        </div>
                        
                        <!-- Click indicator -->
                        <div class="mt-4 text-center">
                            <span class="text-xs text-gray-400">Click to view details</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderProjects(projectsToRender) {
            const container = document.getElementById('projectsContainer');
            const noResults = document.getElementById('noResults');
            
            if (projectsToRender.length === 0) {
                container.innerHTML = '';
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
                container.innerHTML = projectsToRender.map(createProjectCard).join('');
            }
        }

        function filterProjects(searchTerm) {
            const filtered = projects.filter(project => {
                const searchLower = searchTerm.toLowerCase();
                return (
                    project.name.toLowerCase().includes(searchLower) ||
                    project.manager.toLowerCase().includes(searchLower) ||
                    project.status.toLowerCase().includes(searchLower) ||
                    project.category.toLowerCase().includes(searchLower)
                );
            });
            renderProjects(filtered);
        }

        function openProjectModal(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (!project) return;

            const modal = document.getElementById('projectModal');
            const utilizationPercentage = Math.round((project.usedBudget / project.totalBudget) * 100);
            const remainingBudget = project.totalBudget - project.usedBudget;

            // Populate modal content
            document.getElementById('modalTitle').textContent = project.name;
            document.getElementById('modalTotalBudget').textContent = formatCurrency(project.totalBudget);
            document.getElementById('modalUsedBudget').textContent = formatCurrency(project.usedBudget);
            document.getElementById('modalRemainingBudget').textContent = formatCurrency(remainingBudget);
            document.getElementById('modalUtilizationPercent').textContent = utilizationPercentage + '%';
            document.getElementById('modalManager').textContent = project.manager;
            document.getElementById('modalCategory').textContent = project.category;
            
            // Set status with color
            const statusElement = document.getElementById('modalStatus');
            statusElement.textContent = project.status;
            statusElement.className = `ml-2 px-2 py-1 rounded-full text-xs font-medium ${getStatusColor(project.status)}`;

            // Set progress bar
            const progressBar = document.getElementById('modalProgressBar');
            progressBar.style.width = utilizationPercentage + '%';
            progressBar.className = `h-4 rounded-full transition-all duration-500 ${getBudgetColor(utilizationPercentage)}`;

            // Populate expenses table
            const expensesList = document.getElementById('expensesList');
            expensesList.innerHTML = project.expenses.map(expense => `
                <tr class="hover:bg-gray-50">
                    <td class="px-4 py-3 text-sm text-gray-900">${expense.description}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${expense.category}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${new Date(expense.date).toLocaleDateString()}</td>
                    <td class="px-4 py-3 text-sm font-medium text-gray-900 text-right">${formatCurrency(expense.amount)}</td>
                </tr>
            `).join('');

            // Show modal
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeProjectModal() {
            const modal = document.getElementById('projectModal');
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // Authentication functions
        function showLogin() {
            document.getElementById('loginModal').classList.remove('hidden');
        }

        function hideLogin() {
            document.getElementById('loginModal').classList.add('hidden');
        }

        function login(username, password) {
            if (username === adminCredentials.username && password === adminCredentials.password) {
                isLoggedIn = true;
                hideLogin();
                document.getElementById('adminBtn').textContent = 'Admin Panel';
                document.getElementById('logoutBtn').classList.remove('hidden');
                return true;
            }
            return false;
        }

        function logout() {
            isLoggedIn = false;
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('adminBtn').textContent = 'Admin Panel';
            document.getElementById('logoutBtn').classList.add('hidden');
        }

        // Excel file processing
        function processExcelFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Process main projects sheet
                    const projectsSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const projectsData = XLSX.utils.sheet_to_json(projectsSheet);
                    
                    // Process expenses sheet (if exists)
                    let expensesData = [];
                    if (workbook.SheetNames.length > 1) {
                        const expensesSheet = workbook.Sheets[workbook.SheetNames[1]];
                        expensesData = XLSX.utils.sheet_to_json(expensesSheet);
                    }
                    
                    // Transform data to match our format
                    projects = projectsData.map((row, index) => {
                        const projectId = index + 1;
                        const projectExpenses = expensesData.filter(expense => 
                            expense['Project ID'] === projectId || 
                            expense['ProjectID'] === projectId ||
                            expense['Project_ID'] === projectId
                        );
                        
                        return {
                            id: projectId,
                            name: row['Name'] || row['Project Name'] || row['ProjectName'] || 'Unnamed Project',
                            manager: row['Manager'] || row['Project Manager'] || row['ProjectManager'] || 'Unknown',
                            status: row['Status'] || 'Unknown',
                            totalBudget: parseFloat(row['Total Budget'] || row['TotalBudget'] || row['Budget'] || 0),
                            usedBudget: parseFloat(row['Used Budget'] || row['UsedBudget'] || row['Spent'] || 0),
                            category: row['Category'] || row['Type'] || 'General',
                            expenses: projectExpenses.map(expense => ({
                                description: expense['Description'] || expense['Item'] || 'Unknown expense',
                                category: expense['Category'] || expense['Type'] || 'General',
                                date: expense['Date'] || new Date().toISOString().split('T')[0],
                                amount: parseFloat(expense['Amount'] || expense['Cost'] || 0)
                            }))
                        };
                    });
                    
                    // Update UI
                    renderProjects(projects);
                    document.getElementById('uploadStatus').innerHTML = `
                        <div class="text-green-600">
                            ✓ Successfully loaded ${projects.length} projects
                        </div>
                    `;
                    
                } catch (error) {
                    document.getElementById('uploadStatus').innerHTML = `
                        <div class="text-red-600">
                            ✗ Error processing file: ${error.message}
                        </div>
                    `;
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Render projects on page load
            renderProjects(projects);
            
            // Login form handler
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                if (login(username, password)) {
                    document.getElementById('adminPanel').classList.remove('hidden');
                } else {
                    const errorDiv = document.getElementById('loginError');
                    errorDiv.textContent = 'Invalid credentials. Please try again.';
                    errorDiv.classList.remove('hidden');
                }
            });

            // Admin panel toggle
            document.getElementById('adminBtn').addEventListener('click', function() {
                if (!isLoggedIn) {
                    showLogin();
                    return;
                }
                
                const panel = document.getElementById('adminPanel');
                panel.classList.toggle('hidden');
            });

            // Logout handler
            document.getElementById('logoutBtn').addEventListener('click', logout);

            // File upload handler
            document.getElementById('fileInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    document.getElementById('fileName').textContent = file.name;
                    document.getElementById('uploadStatus').innerHTML = `
                        <div class="text-blue-600">
                            📄 Processing ${file.name}...
                        </div>
                    `;
                    processExcelFile(file);
                }
            });
            
            // Search functionality
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function(e) {
                filterProjects(e.target.value);
            });

            // Modal close functionality
            document.getElementById('closeModal').addEventListener('click', closeProjectModal);
            
            // Close modal when clicking outside
            document.getElementById('projectModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeProjectModal();
                }
            });

            // Close modal with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeProjectModal();
                }
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'983f67ef561afee1',t:'MTc1ODY4Njc1My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
